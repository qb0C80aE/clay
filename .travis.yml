language: go
go: 1.8

notifications:
 email: false

before_install:
 - go version
 - sudo apt-get -qq update

install:
 - sudo apt-get -qq install -y gcc-multilib
 - go get github.com/Masterminds/glide
 - go get github.com/mattn/go-bindata/...

script:
 - glide install
 - go generate -tags=prebuild ./...
 - (cd vendor/github.com/qb0C80aE/pottery/; go generate -tags=prebuild ./...)
 - GOOS=linux GOARCH=amd64 go build --ldflags '-extldflags "-static"' -o linux_amd64/clay/clay

after_success:
 - (cd linux_amd64; tar zcvf ../clay.bastet.linux-amd64.tgz clay)
 - ls -la
 - ./upload.sh
